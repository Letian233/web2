<!DOCTYPE html>
<html lang="en" data-current-user='{{ current_user|tojson|safe }}' data-initial-reviews='{{ initial_reviews|tojson|safe }}'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hamberger.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') }}">
    <script src="{{ url_for('static', filename='js/jQuery_v3.7.1.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/pages.js') }}"></script>
    <script src="{{ url_for('static', filename='js/hamberger.js') }}"></script>
    <script src="{{ url_for('static', filename='js/data.js') }}"></script>
    <script src="{{ url_for('static', filename='js/cart.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/reviews.js') }}"></script>
</head>
<body class="reviews-page">
    <!-- User menu - Fixed at top right corner -->
    <div id="userMenuContainer" class="user-menu-fixed"></div>
    <div id="container">
        <header>
          <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container-fluid">
              <button class="navbar-toggler hamburger" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto" id="nav">
                  <li class="nav-item"><a class="nav-link" href="{{ url_for('index') }}">Home</a></li>
                  <li class="nav-item"><a class="nav-link" href="{{ url_for('about') }}">About</a></li>
                  <li class="nav-item"><a class="nav-link" href="{{ url_for('menu') }}">Menu</a></li>
                  <li class="nav-item"><a class="nav-link current" href="{{ url_for('reviews') }}">Review</a></li>
                </ul>
              </div>
            </div>
          </nav>
        </header>
        
    <div class="wrapper">
      <div class="container">
        <div class="border"></div>
        
        <div class="row mt-4">
          <!-- Left comment area -->
          <div class="col-12 col-lg-8">
            <article>
              <h3>Reviews</h3>
              
              <!-- Form 1: Top static form (located above comment list) -->
              <div class="bili-comment-input" id="static-review-form">
                <div class="comment-avatar">
                  <div class="avatar-circle" id="currentUserAvatar">U</div>
                </div>
                <div class="comment-input-wrapper">
                  <label for="review-text" class="visually-hidden">Share your thoughts</label>
                  <textarea 
                    id="review-text" 
                    class="comment-textarea" 
                    placeholder="Share your thoughts..."
                    rows="3"
                  ></textarea>
                </div>
                <button type="button" class="comment-submit-btn" id="submitReviewBtn">Send</button>
              </div>

              <!-- Comment display container (fixed height, internal scrolling) -->
              <div class="reviews-widget">
                <!-- Scroll area -->
                <div class="reviews-scroll-area" id="reviews-scroll-area">
                  <!-- Comment list container (scrolling within container) -->
                  <div id="reviews-list" class="bili-comments-list">
                    <!-- Comments will be dynamically generated here -->
                  </div>
                </div>

                <!-- Form 2: Bottom sticky bar (fixed at bottom of comment area, hidden by default) -->
                <div id="sticky-bottom-bar" class="sticky-bottom-bar" aria-hidden="true">
                  <div class="sticky-bar-content">
                    <div class="comment-avatar">
                      <div class="avatar-circle" id="stickyUserAvatar">U</div>
                    </div>
                    <div class="sticky-input-wrapper">
                      <label for="sticky-review-text" class="visually-hidden">Quick reply</label>
                      <textarea 
                        id="sticky-review-text" 
                        class="sticky-textarea" 
                        placeholder="Share your thoughts..."
                        rows="1"
                      ></textarea>
                    </div>
                    <button type="button" class="sticky-submit-btn" id="stickySubmitBtn">Send</button>
                  </div>
                </div>
              </div>
            </article>
          </div>
          
          <!-- Right sidebar - Article list -->
          <div class="col-12 col-lg-4 mt-4 mt-lg-0">
            <aside class="sidebar bili-sidebar">
                <h3>Featured Articles</h3>
              <div class="bili-article-list">
                {% if articles_list %}
                  {% for article in articles_list %}
                  <a href="{{ url_for('about') }}?article={{ article.id }}" class="bili-article-card">
                    <div class="bili-article-thumb">
                      {% if article.image_url %}
                        <img src="{{ article.image_url if article.image_url.startswith('http') or article.image_url.startswith('/') else url_for('static', filename=article.image_url) }}" alt="{{ article.title }}">
                      {% else %}
                        <div class="bili-article-placeholder">
                          <span>{{ article.title[:1] }}</span>
                        </div>
                      {% endif %}
                    </div>
                    <div class="bili-article-info">
                      <h4 class="bili-article-title">{{ article.title }}</h4>
                      <div class="bili-article-meta">
                        <span class="bili-article-category">{{ article.section_name }}</span>
                        {% if article.updated_at %}
                        <span class="bili-article-date">{{ article.updated_at }}</span>
                        {% endif %}
                      </div>
                    </div>
                  </a>
                  {% endfor %}
                {% else %}
                  <div class="bili-no-articles">
                    <p>No articles yet</p>
                  </div>
                {% endif %}
              </div>
            </aside>
          </div>
        </div>
        
        <div class="border2 mt-4"></div>
      </div>
    </div>
  </div>
</body>
</html>
